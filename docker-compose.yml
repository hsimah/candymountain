version: "3.7"

services:
  www:
    depends_on:
      - wordpress
    image: nginx:1.15.12-alpine
    container_name: "${DOCKER_APP_NAME}_www"
    ports:
      - "80:80"
    volumes:
      - wordpress:/var/www/html
      - .docker/nginx:/etc/nginx/conf.d
    networks:
      - network

  wordpress:
    build:
      context: .
      dockerfile: .docker/Dockerfile.wordpress
    container_name: "${DOCKER_APP_NAME}_wordpress"
    depends_on:
      - db
    env_file: 
      - .docker/.env.wordpress
    volumes:
      - wordpress:/var/www/html
      - ./plugins:/var/www/html/wp-content/plugins
    networks:
      - network
    ports:
      - 6969
      - 9000
    extra_hosts: 
      - "wsl:172.26.126.157"

  db:
    container_name: "${DOCKER_APP_NAME}_db"
    build:
      context: .
      dockerfile: .docker/Dockerfile.db
    env_file: 
        - .docker/.env.db
    volumes:
      - database:/var/lib/mysql
    networks:
      - network
    ports:
      - 3306

volumes:
  database:
  wordpress:
  
networks:
  network:
    name: "${DOCKER_APP_NAME}_network"
    driver: bridge 